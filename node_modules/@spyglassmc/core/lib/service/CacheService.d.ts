import type { TextDocument } from 'vscode-languageserver-textdocument';
import type { PosRangeLanguageError } from '../source/index.js';
import { SymbolTable } from '../symbol/index.js';
import type { RootUriString } from './fileUtil.js';
import type { Project } from './Project.js';
/**
 * The format version of the cache. Should be increased when any changes that
 * could invalidate the cache are introduced to the Spyglass codebase.
 */
export declare const LatestCacheVersion = 6;
/**
 * Checksums of cached files or roots.
 */
interface Checksums {
    files: Record<string, string>;
    roots: Record<RootUriString, string>;
    symbolRegistrars: Record<string, string>;
}
declare namespace Checksums {
    function create(): Checksums;
}
type ErrorCache = Record<string, readonly PosRangeLanguageError[]>;
interface LoadResult {
    symbols: SymbolTable;
}
interface ValidateResult {
    addedFiles: string[];
    changedFiles: string[];
    removedFiles: string[];
    unchangedFiles: string[];
}
export declare class CacheService {
    #private;
    private readonly cacheRoot;
    private readonly project;
    checksums: Checksums;
    errors: ErrorCache;
    /**
     * @param cacheRoot File path to the directory where cache files by Spyglass should be stored.
     * @param project
     */
    constructor(cacheRoot: RootUriString, project: Project);
    private getCacheFileUri;
    load(): Promise<LoadResult>;
    validate(): Promise<ValidateResult>;
    /**
     * @returns If the cache file was saved successfully.
     */
    save(): Promise<boolean>;
    hasFileChangedSinceCache(doc: TextDocument): Promise<boolean>;
    reset(): LoadResult;
}
export {};
//# sourceMappingURL=CacheService.d.ts.map